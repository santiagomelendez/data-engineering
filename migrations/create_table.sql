-- Create the table
CREATE TABLE IF NOT EXISTS klines (
    id INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    ticker VARCHAR(10),
    open_time TIMESTAMP,
    open_price FLOAT,
    high_price FLOAT,
    low_price FLOAT,
    close_price FLOAT,
    volume FLOAT,
    close_time TIMESTAMP,
    quote_asset_volume FLOAT,
    number_of_trades INT,
    symbol VARCHAR(10),
);

-- Insert the JSON data
INSERT INTO klines (
    ticker, open_time, open_price, high_price, low_price, close_price,
    volume, close_time, quote_asset_volume, number_of_trades) VALUES 
('btcusdt' , '2024-01-17 04:00:00',  42849.0,  42921.1,42781.49, 42854.01, 791.4, '2024-01-17 04:59:59.999', 33911017.91, 32838),
('btcusdt', '2024-01-17 05:00:00', 42854.01, 42925.49,42765.41, 42783.39, 661.25, '2024-01-17 05:59:59.999', 28333635.53, 30696),
('btcusdt', '2024-01-17 06:00:00', 42783.39, 42876.34,42766.0, 42806.05, 802.28, '2024-01-17 06:59:59.999', 34360257.7, 28881),
('btcusdt', '2024-01-17 07:00:00', 42806.05, 42851.1,42619.6, 42655.94, 1357.31, '2024-01-17 07:59:59.999', 58019581.23, 46737),
('btcusdt', '2024-01-17 08:00:00', 42655.95, 42747.65,42564.0, 42728.76, 1188.19, '2024-01-17 08:59:59.999', 50705137.24, 52602),
('btcusdt', '2024-01-17 09:00:00', 42728.76, 42830.0,42674.0, 42678.57, 938.27, '2024-01-17 09:59:59.999', 40133807.74, 35711),
('btcusdt', '2024-01-17 10:00:00', 42678.56, 42850.55,42622.36, 42850.04, 1193.04, '2024-01-17 10:59:59.999', 50992942.63, 45910),
('btcusdt', '2024-01-17 11:00:00', 42850.05, 42850.55,42672.95, 42680.16, 1093.25, '2024-01-17 11:59:59.999', 46744078.12, 60902),
('btcusdt', '2024-01-17 12:00:00', 42680.16, 42788.0,42411.0, 42782.43, 2445.67, '2024-01-17 12:59:59.999', 104256628.1, 83991),
('btcusdt', '2024-01-17 13:00:00', 42782.42, 42782.43,42518.0, 42609.84, 1305.63, '2024-01-17 13:59:59.999', 55679740.1, 58544),
('btcusdt', '2024-01-17 14:00:00', 42609.83, 42926.02,42365.58, 42576.01, 3407.7, '2024-01-17 14:59:59.999', 145182249.15, 143369),
('btcusdt', '2024-01-17 15:00:00', 42576.02, 42768.0,42472.85, 42482.79, 2383.9, '2024-01-17 15:59:59.999', 101584572.74, 109007),
('btcusdt', '2024-01-17 16:00:00', 42482.8, 42564.13,42250.31, 42360.28, 2301.06, '2024-01-17 16:59:59.999', 97587690.13, 89181),
('btcusdt', '2024-01-17 17:00:00', 42360.29, 42470.32,42200.69, 42371.1, 1419.22, '2024-01-17 17:59:59.999', 60111435.19, 65104),
('btcusdt', '2024-01-17 18:00:00', 42371.1, 42612.48,42278.98, 42612.45, 1471.84, '2024-01-17 18:59:59.999', 62478729.36, 62455),
('btcusdt', '2024-01-17 19:00:00', 42612.46, 42745.99,42555.22, 42611.11, 1041.37, '2024-01-17 19:59:59.999', 44403759.73, 46391),
('btcusdt', '2024-01-17 20:00:00', 42611.1, 42876.48,42559.29, 42722.9, 2990.71, '2024-01-17 20:59:59.999', 127754991.22, 157049),
('btcusdt', '2024-01-17 21:00:00', 42722.9, 42822.96,42603.2, 42676.13, 1125.25, '2024-01-17 21:59:59.999', 48057504.41, 71096),
('btcusdt', '2024-01-17 22:00:00', 42676.14, 42729.06,42450.0, 42722.14, 767.12, '2024-01-17 22:59:59.999', 32694649.18, 40647),
('btcusdt', '2024-01-17 23:00:00', 42722.13, 42792.48,42619.73, 42776.1, 869.8, '2024-01-17 23:59:59.999', 37150704.88, 39932),
('btcusdt', '2024-01-18 00:00:00', 42776.09, 42784.4,42617.31, 42660.79, 877.07, '2024-01-18 00:59:59.999', 37458288.35, 33020),
('btcusdt', '2024-01-18 01:00:00', 42660.79, 42713.92,42502.19, 42584.62, 814.28, '2024-01-18 01:59:59.999', 34681966.04, 37756),
('btcusdt', '2024-01-18 02:00:00', 42584.61, 42721.0,42584.12, 42653.82, 563.7, '2024-01-18 02:59:59.999', 24052090.46, 27372),
('btcusdt', '2024-01-18 03:00:00', 42653.81, 42676.75,42550.0, 42575.99, 394.94, '2024-01-18 03:59:59.999', 16830172.35, 18003)
;